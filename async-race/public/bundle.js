(()=>{"use strict";var e={474:(e,t,a)=>{a.r(t)},604:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const r=a(191),n=a(873),c=a(354),o=a(787),s=a(454),l=a(527),d=a(7),i=a(641);t.App=class{constructor(){this.winnersController=new l.WinnersController(new d.WinnersView,new i.WinnersService);const e=new n.GarageView(null);this.garageController=new r.GarageController(e,new c.GarageService),e.garageController=this.garageController;const t=new s.HeaderView(null);this.headerController=new o.HeaderController(t,this.garageController,this.winnersController),t.headerController=this.headerController}start(){this.headerController.drawHeader(),this.garageController.drawPage()}}},787:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderController=void 0,t.HeaderController=class{constructor(e,t,a){this.headerView=e,this.garageController=t,this.winnersController=a}drawHeader(){this.headerView.createHeader()}drawWinnersPage(){this.winnersController.removePage(),this.garageController.removePage(),this.winnersController.drawPage()}drawGaragePage(){this.winnersController.removePage(),this.garageController.removePage(),this.garageController.drawPage()}}},454:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderView=void 0,t.HeaderView=class{constructor(e){this.headerController=e}createHeader(){const e=document.body,t=document.createElement("header");t.className="header";const a=document.createElement("div");a.className="container";const r=document.createElement("div");r.className="header__container";const n=document.createElement("button");n.className="header__btn-to-garage",n.textContent="to garage",n.addEventListener("click",(()=>this.headerController?.drawGaragePage()));const c=document.createElement("button");c.className="header__btn-to-winners",c.textContent="to winners",c.addEventListener("click",(()=>this.headerController?.drawWinnersPage())),r.append(n),r.append(c),a.append(r),t.append(a),e.prepend(t)}}},191:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageController=void 0,t.GarageController=class{constructor(e,t){this.garageView=e,this.garageService=t}drawPage(){this.garageService.fetchCars((e=>this.garageView.renderGarage(e)))}addCar(e,t){this.garageService.addCar(e,t,(e=>this.garageView.onUpdateGarage(e)))}deleteCar(e){this.garageService.deleteCar(e,(e=>this.garageView.onUpdateGarage(e)))}saveCarIdForUpdate(e){this.garageService.saveCarIdForUpdate(e)}updateCar(e,t){this.garageService.updateCar(e,t,(e=>this.garageView.onUpdateGarage(e)))}removePage(){this.garageView?.deleteGaragePage()}}},354:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageService=void 0,t.GarageService=class{fetchCars(e){fetch("http://127.0.0.1:3000/garage").then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()})).then((t=>e(t)))}addCar(e,t,a){fetch("http://127.0.0.1:3000/garage",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:e,color:t})}).then((e=>{if(!e.ok)throw new Error(e.statusText);this.fetchCars(a)}))}deleteCar(e,t){fetch(`http://127.0.0.1:3000/garage/${e}`,{method:"DELETE"}).then((e=>{if(!e.ok)throw new Error(e.statusText);this.fetchCars(t)}))}saveCarIdForUpdate(e){localStorage.setItem("updateCarId",e.toString())}getCarIdForUpdate(){const e=localStorage.getItem("updateCarId");if(e)return+e;throw new Error}updateCar(e,t,a){const r=this.getCarIdForUpdate();fetch(`http://127.0.0.1:3000/garage/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,color:t})}).then((e=>{if(!e.ok)throw new Error(e.statusText);this.fetchCars(a)}))}}},873:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GarageView=void 0,t.GarageView=class{constructor(e){this.garageController=e}renderGarage(e){const t=document.querySelector(".header"),a=document.createElement("main");a.className="garage";const r=document.createElement("div");r.className="garage__container";const n=this.createCarsControlBlock(e);r.append(n),a.append(r),t.after(a)}createCarsControlBlock(e){const t=document.createElement("div");t.className="garage__cars-control-block";const a=this.createCarsWrapper(),r=this.createUpdateCarsWrapper(),n=this.createControlCarsWrapper(),c=this.createRaceWrapper(e);return t.append(a),t.append(r),t.append(n),t.append(c),t}createCarsWrapper(){const e=document.createElement("div");e.className="garage__wrapper-create-cars";const t=document.createElement("input");t.type="text",t.className="garage__create-car-name";const a=document.createElement("input");a.className="garage__create-car-color",a.type="color";const r=document.createElement("button");return r.className="garage__btn-create-car",r.textContent="create",r.addEventListener("click",(()=>{const e=document.querySelector(".garage__create-car-name"),t=document.querySelector(".garage__create-car-color");this.garageController?.addCar(e.value,t.value)})),e.append(t),e.append(a),e.append(r),e}createUpdateCarsWrapper(){const e=document.createElement("div");e.className="garage__wrapper-update-cars";const t=document.createElement("input");t.type="text",t.className="garage__update-car-name";const a=document.createElement("input");a.className="garage__update-cfr-color",a.type="color";const r=document.createElement("button");return r.className="garage__btn-update-car",r.textContent="update",r.addEventListener("click",(()=>{const e=document.querySelector(".garage__update-car-name"),t=document.querySelector(".garage__update-cfr-color");this.garageController?.updateCar(e.value,t.value)})),e.append(t),e.append(a),e.append(r),e}createControlCarsWrapper(){const e=document.createElement("div");e.className="garage__wrapper-control-cars";const t=document.createElement("button");t.className="garage__btn-race",t.textContent="race";const a=document.createElement("button");a.className="garage__btn-reset",a.textContent="reset";const r=document.createElement("button");return r.className="garage__btn-generate-cars",r.textContent="generate cars",e.append(t),e.append(a),e.append(r),e}createRaceWrapper(e){const t=document.createElement("div");t.className="garage__wrapper-race";const a=this.createRaceTitle(e.length),r=this.createRacePage(1),n=this.createCarBlockWrapper(e);return t.append(a),t.append(r),t.append(n),t}createCarBlockWrapper(e){const t=document.createElement("div");return t.className="garage__wrapper-car-block",e.slice(0,7).forEach((e=>{const a=this.createCarBlock(e);t.append(a)})),t}createCarBlock(e){const t=document.createElement("div");t.className="garage__car-block";const a=this.createActionWrapper(e),r=this.createCarDirectionWrapper(),n=this.createVisualCarWrapper(e);return t.append(a),t.append(r),t.append(n),t}createRaceTitle(e){const t=document.createElement("div");t.className="garage__wrapper-race-title";const a=document.createElement("h2");a.className="garage__race-title",a.textContent="Garage ";const r=document.createElement("p");return r.className="garage__race-count",r.textContent=` (${e.toString()})`,t.append(a),t.append(r),t}createRacePage(e){const t=document.createElement("div");t.className="garage__wrapper-race-page";const a=document.createElement("h3");a.className="garage__page-title",a.textContent="page ";const r=document.createElement("p");return r.className="garage__page",r.textContent=`#${e}`,t.append(a),t.append(r),t}createActionWrapper(e){const t=document.createElement("div");t.className="garage__wrapper-action";const a=document.createElement("button");a.className="garage__btn-remove",a.textContent="remove",a.addEventListener("click",(()=>this.garageController?.deleteCar(e.id)));const r=document.createElement("button");r.className="garage__btn-select",r.textContent="select",r.addEventListener("click",(()=>this.garageController?.saveCarIdForUpdate(e.id)));const n=document.createElement("div");return n.className="garage__care-name",n.textContent=e.name,t.append(a),t.append(r),t.append(n),t}createCarDirectionWrapper(){const e=document.createElement("div");e.className="garage__wrapper-car-direction";const t=document.createElement("button");t.className="garage__wrapper-direction-a",t.textContent="A";const a=document.createElement("button");return a.className="garage__wrapper-direction-b",a.textContent="B",e.append(t),e.append(a),e}createVisualCarWrapper(e){const t=document.createElement("div");t.className="garage__wrapper-visual-car";const a=document.createElement("div");return a.className="garage__visual-car",a.style.backgroundColor=e.color,t.append(a),t}onUpdateGarage(e){document.querySelector(".garage__wrapper-car-block")?.remove();const t=this.createCarBlockWrapper(e);document.querySelector(".garage__race-count").textContent=`(${e.length})`,document.querySelector(".garage__wrapper-race-page")?.after(t)}deleteGaragePage(){document.querySelector(".garage")?.remove()}}},527:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersController=void 0,t.WinnersController=class{constructor(e,t){this.winnersView=e,this.winnersService=t}drawPage(){this.winnersView.renderWinners(),this.winnersService.fetchWinnersCars((e=>this.winnersView.renderWinnersElementsTable(e)),(e=>this.winnersView.renderWinnersTitle(e)))}removePage(){this.winnersView?.deleteWinnersPage()}}},641:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersService=void 0,t.WinnersService=class{fetchWinnersCars(e,t){const a=new URLSearchParams([["_page","0"],["_limit","5"],["_sort","id"],["_order","ASC"]]).toString();fetch("http://127.0.0.1:3000/winners?"+a).then((e=>{if(!e.ok)throw new Error(e.statusText);const a=e.headers.get("X-Total-Count");return t(a?+a:0),e.json()})).then((t=>(t.forEach((t=>{this.fillWinnerByCar(t,e)})),t)))}fillWinnerByCar(e,t){fetch(`http://127.0.0.1:3000/garage/${e.id}`).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()})).then((a=>{e.name=a.name,e.color=a.color,t(e)}))}}},7:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnersView=void 0,t.WinnersView=class{renderWinners(){const e=document.querySelector(".header"),t=document.createElement("main");t.className="winners";const a=document.createElement("div");a.className="winners__container";const r=this.createWinnersCountPage(),n=this.createChangePageWrapper(),c=this.createWinnersTable();a.append(r),a.append(n),a.append(c),t.append(a),e.after(t)}renderWinnersTitle(e){const t=document.querySelector(".winners__wrapper-count-page"),a=document.createElement("div");a.className="winners__wrapper-winner-title";const r=document.createElement("h2");r.className="winners__winner-title",r.textContent="Winners ";const n=document.createElement("p");n.className="winners__winner-count",n.textContent=`(${e})`,a.append(r),a.append(n),t.before(a)}createWinnersCountPage(){const e=document.createElement("div");e.className="winners__wrapper-count-page";const t=document.createElement("h3");t.className="winners__page-title",t.textContent="page";const a=document.createElement("p");return a.className="winners__page",a.textContent="#1",e.append(t),e.append(a),e}createWinnersTable(){const e=document.createElement("table");e.className="winners__winners-table";const t=this.createWinnersHeadTable();return e.append(t),e}createWinnersHeadTable(){const e=document.createElement("tr");e.className="winners__head-table";const t=document.createElement("th");t.className="winners__car-number-title",t.textContent="Number";const a=document.createElement("th");a.className="winners__car-title",a.textContent="Car";const r=document.createElement("th");r.className="winners__car-name-title",r.textContent="Name";const n=document.createElement("th");n.className="winners__car-wins-title",n.textContent="Wins";const c=document.createElement("th");return c.className="winners__best-time-title",c.textContent="Best time (seconds)",e.append(t),e.append(a),e.append(r),e.append(n),e.append(c),e}renderWinnersElementsTable(e){const t=document.createElement("tr");t.className="winners__table";const a=document.createElement("td");a.className="winners__car-number",a.textContent=e.id.toString();const r=document.createElement("td");r.className="winners__car",r.style.backgroundColor=e.color;const n=document.createElement("td");n.className="winners__car-name",n.textContent=e.name;const c=document.createElement("td");c.className="winners__car-wins",c.textContent=e.wins.toString();const o=document.createElement("td");o.className="winners__best-time",o.textContent=e.time.toString(),t.append(a),t.append(r),t.append(n),t.append(c),t.append(o),document.querySelector(".winners__head-table")?.after(t)}createChangePageWrapper(){const e=document.createElement("div");e.className="winners__wrapper-change-page";const t=document.createElement("button");t.className="winners__prev-btn",t.textContent="prev";const a=document.createElement("button");return a.className="winners__next-btn",a.textContent="next",e.append(t),e.append(a),e}deleteWinnersPage(){document.querySelector(".winners")?.remove()}}}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,a),c.exports}a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(474),(new(a(604).App)).start()})();